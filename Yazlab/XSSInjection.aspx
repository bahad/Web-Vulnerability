<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="XSSInjection.aspx.cs" Inherits="Yazlab.XSSInjection" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
     
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link href="CSS/XSS.css" rel="stylesheet" />
</head>
<body>
    <form id="form1" runat="server">
    <div class="kutu">
        <div class="yardım"> 
            <!-- Trigger the modal with a button -->
<button type="button" class="btn btn-info btn-md" data-toggle="modal" data-target="#myModal">Yardım</button>

<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">XSS Injection</h4>
      </div>
      <div class="modal-body">
        <p>Cross-Site Scripting web uygulamalarında zararlı komutların eklendiği bir
            saldırı türüdür.Xss açıkları istemci tarafında yürütülen komut dosyalarını hedefler.
        </p>
          <p style="text-align: center; color: #FF0000">Örnek Kod</p>
          <p>XSSInjection.aspx sayfasında</p> 
           <p><code>string id = TextBox1.Text; </code></p>    
           <p><code>Response.Redirect("XssSonuc.aspx?id=" + id);</code></p> 
              XssSonuc.aspx sayfasına id parametresi yollanmaktadır.
              
          <p>Daha sonra XssSonuc.aspx sayfasında <code>string id=""</code> komutuyla id adlı değişken
              tanımlanmıştır. </p>
          <p><code>protected void Page_Load(object sender, EventArgs e)</code></p>
       <p>{ </p> 
          <p><code> id = Request.QueryString["id"];</code></p>
           <p><code>  Response.Write(id);</code></p>
        <p>}</p>
       <p>Bu kodda Xss açığının olmasının ilk nedeni, oluşturulan <strong>WebConfig</strong> dosyasında</p>
              <p><code> targetFramework="4.5.2" requestValidationMode="2.0"  </code></p>
              <p><code> buffer="true" validateRequest="false"</code></p>
          <p> kodlarının yerleştirilmesidir. Bu kod .Net için varolan xss güvenlik önlemini devredışı
          bırakmaktadır.Zafiyetin varolmasındaki diğer bir nedense uygulamada  özel karakterler
          için herhangi bir filtreleme bulunmamasıdır. Böylece saldırgan url üzerinde zararlı bir takım 
          kodlar yazabilir. 
          </p>
          <p style="color: #FF0000; text-align: center">Örnek Sömürü</p>
          <p>Sonuclar XssSonuc.aspx sayfasında görüntülenmektedir. Örnek saldırı için Internet Explorer
             üzerinde <br /><strong>http://localhost:56707/XssSonuc.aspx?id=< script> alert("hacked") < /script></strong> 
         <br /> Url si girildiğinde ekrana hacklendiniz yazısı çıkmaktadır. </p>
         <p style="color: #FF0000; text-align: center">Doğru Kod</p>
          <p>Xss ten korunmak için ilk olarak yukarda gösterilen WebConfig dosyasındaki
              <code>validateRequest="false"</code> değeri <code>true</code> yapılır.</p>
          <p>İkinci önlem olarak .Net platformu için geliştirilmiş olan AntiXSS kütüphanesi 
              kullanılabilir.Diğer bir yöntem ise özel karakterlerin girilmesini engelleyen 
              String.Replace yöntemidir.Bu yöntem için HtmlEncode yöntemi kullanılmaktadır.</p>
          <p><img src="Resim/cikti.png" /></p>
          <p>Burdaki kodda görüldüğü gibi zararlı olabilecek bazı kodlar filtrelenmiştir.Boylece 
              kullanıcının < > gibi karakterler girmesi engellenmiş olacaktır.
          </p>                                                                                          
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Çıkış</button>
      </div>
    </div>

  </div>
</div>
        </div>
        <div class="icerik">
        <asp:TextBox ID="TextBox1" runat="server" CssClass="text-info text-lg" Height="30px" style="margin-top: 0"></asp:TextBox>
        <asp:Button ID="Button1" runat="server" Text="Button" OnClick="Button1_Click" CssClass="btn-primary" Height="30px" />
        </div>

    </div>
        
        
    
    </form>
</body>
</html>
